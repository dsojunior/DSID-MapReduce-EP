/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package mapReduce.runner;

import java.util.List;
import java.util.Map;
import javax.swing.JOptionPane;

import mapReduce.DesvioPadrao.DpReducer;
import mapReduce.Max.MaxReducer;
import mapReduce.Media.MediaReducer;
import mapReduce.Mediana.MedianaReducer;
import mapReduce.Min.MinReducer;
import mapReduce.Moda.ModaReducer;
import mapReduce.mappers.GroupMapper;
import mapReduce.util.MapaEstacoes;
import mapReduce.util.StatisticsJobConf;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Reducer;

/**
 *
 * @author caio
 */
public class StatisticsGUI extends javax.swing.JFrame {

    /**
     * Creates new form StatisticsGUI
     */
    public StatisticsGUI() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        painelAbas = new javax.swing.JTabbedPane();
        abaFuncoes = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        comboFuncoes = new javax.swing.JComboBox<>();
        lblVariavel = new javax.swing.JLabel();
        comoVariaiveis = new javax.swing.JComboBox<>();
        jLabel2 = new javax.swing.JLabel();
        comboAgrupar = new javax.swing.JComboBox<>();
        jSeparator2 = new javax.swing.JSeparator();
        jLabel3 = new javax.swing.JLabel();
        lblPeriodo = new javax.swing.JLabel();
        dtChooserDe = new com.toedter.calendar.JDateChooser();
        jLabel4 = new javax.swing.JLabel();
        jDateChooser1 = new com.toedter.calendar.JDateChooser();
        jLabel5 = new javax.swing.JLabel();
        comboPaises = new javax.swing.JComboBox<>();
        lblEstacao = new javax.swing.JLabel();
        comboEstacao = new javax.swing.JComboBox<>();
        btnExecutar = new javax.swing.JButton();
        jSeparator3 = new javax.swing.JSeparator();
        lblSaida = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        txtSaida = new javax.swing.JTextArea();
        lblDirEntrada = new javax.swing.JLabel();
        txtDirEntrada = new javax.swing.JTextField();
        lblDirSaida = new javax.swing.JLabel();
        txtDirSaida = new javax.swing.JTextField();
        lblArquivos = new javax.swing.JLabel();
        jSeparator4 = new javax.swing.JSeparator();
        abaPredicao = new javax.swing.JPanel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("EP de DSID");

        jLabel1.setText("Função:");

        comboFuncoes.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Média", "Desvio Padrão", "Máximo", "Mínimo", "Mediana", "Moda" }));

        lblVariavel.setText("Variável:");

        comoVariaiveis.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "TEMP - Temperatura média do dia", "YEAR - Ano", "MONTH - Mês", "DAY - Dia", "DEWP - N Sei", "SLP - Pressão ao nível do mar", "STP - Pressão Atmosférica", "VISIB - Visibilidade", "WDSP - Velocidade média do vento", "MXSPD - Velocidade máxima do vento", "GUST - N Sei", "MAX - Temperatura máxima do dia", "MIN - Temperatura mínima do dia", "PRCP - Precipitação", "SNDP - N sei" }));
        comoVariaiveis.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                comoVariaiveisActionPerformed(evt);
            }
        });

        jLabel2.setText("Agrupar por: ");

        comboAgrupar.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Y - Ano", "MY - Mês/Ano", "W - Dia da Semana", "C - País", "S - Estação" }));

        jLabel3.setFont(new java.awt.Font("Ubuntu", 1, 15)); // NOI18N
        jLabel3.setText("Filtros");

        lblPeriodo.setText("Período:");

        jLabel4.setText("até");

        jLabel5.setText("País:");

        comboPaises.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "TODOS", "AA - ARUBA", "AC - ANTIGUA AND BARBUDA", "AF - AFGHANISTAN", "AG - ALGERIA", "AI - ASCENSION ISLAND", "AJ - AZERBAIJAN", "AL - ALBANIA", "AM - ARMENIA", "AN - ANDORRA", "AO - ANGOLA", "AQ - AMERICAN SAMOA", "AR - ARGENTINA", "AS - AUSTRALIA", "AT - ASHMORE AND CARTIER ISLANDS", "AU - AUSTRIA", "AV - ANGUILLA", "AX - ANTIGUA, ST. KITTS, NEVIS, BARBUDA", "AY - ANTARCTICA", "AZ - AZORES", "BA - BAHRAIN", "BB - BARBADOS", "BC - BOTSWANA", "BD - BERMUDA", "BE - BELGIUM", "BF - BAHAMAS THE", "BG - BANGLADESH", "BH - BELIZE", "BK - BOSNIA AND HERZEGOVINA", "BL - BOLIVIA", "BM - BURMA", "BN - BENIN", "BO - BELARUS", "BP - SOLOMON ISLANDS", "BQ - NAVASSA ISLAND", "BR - BRAZIL", "BS - BASSAS DA INDIA", "BT - BHUTAN", "BU - BULGARIA", "BV - BOUVET ISLAND", "BX - BRUNEI", "BY - BURUNDI", "BZ - BELGIUM AND LUXEMBOURG", "CA - CANADA", "CB - CAMBODIA", "CC - CEUTA AND MELILLA", "CD - CHAD", "CE - SRI LANKA", "CF - CONGO", "CG - ZAIRE", "CH - CHINA", "CI - CHILE", "CJ - CAYMAN ISLANDS", "CK - COCOS (KEELING) ISLANDS", "CL - CAROLINE ISLANDS", "CM - CAMEROON", "CN - COMOROS", "CO - COLOMBIA", "CP - CANARY ISLANDS", "CQ - NORTHERN MARIANA ISLANDS", "CR - CORAL SEA ISLANDS", "CS - COSTA RICA", "CT - CENTRAL AFRICAN REPUBLIC", "CU - CUBA", "CV - CAPE VERDE", "CW - COOK ISLANDS", "CY - CYPRUS", "CZ - CANTON ISLAND", "DA - DENMARK", "DJ - DJIBOUTI", "DO - DOMINICA", "DQ - JARVIS ISLAND", "DR - DOMINICAN REPUBLIC", "DY - DEMOCRATIC YEMEN", "EC - ECUADOR", "EG - EGYPT", "EI - IRELAND", "EK - EQUATORIAL GUINEA", "EN - ESTONIA", "ER - ERITREA", "ES - EL SALVADOR", "ET - ETHIOPIA", "EU - EUROPA ISLAND", "EZ - CZECH REPUBLIC", "FG - FRENCH GUIANA", "FI - FINLAND", "FJ - FIJI", "FK - FALKLAND ISLANDS (ISLAS MALVINAS)", "FM - MICRONESIA, FEDERATED STATES OF", "FO - FAROE ISLANDS", "FP - FRENCH POLYNESIA", "FQ - BAKER ISLAND", "FR - FRANCE", "FS - FRENCH SOUTHERN AND ANTARCTIC LANDS", "GA - GAMBIA  THE", "GB - GABON", "GG - GEORGIA", "GH - GHANA", "GI - GIBRALTAR", "GJ - GRENADA", "GK - GUERNSEY", "GL - GREENLAND", "GM - GERMANY", "GO - GLORIOSO ISLANDS", "GP - GUADELOUPE", "GQ - GUAM", "GR - GREECE", "GT - GUATEMALA", "GV - GUINEA", "GY - GUYANA", "GZ - GAZA STRIP", "HA - HAITI", "HK - HONG KONG", "HM - HEARD ISLAND AND MCDONALD ISLANDS", "HO - HONDURAS", "HQ - HOWLAND ISLAND", "HR - CROATIA", "HU - HUNGARY", "IC - ICELAND", "ID - INDONESIA", "IM - MAN  ISLE OF", "IN - INDIA", "IO - BRITISH INDIAN OCEAN TERRITORY", "IP - CLIPPERTON ISLAND", "IR - IRAN", "IS - ISRAEL", "IT - ITALY", "IV - COTE D'IVOIRE", "IW - ISRAEL-JORDAN DMZ", "IZ - IRAQ", "JA - JAPAN", "JE - JERSEY", "JM - JAMAICA", "JN - JAN MAYEN", "JO - JORDAN", "JQ - JOHNSTON ATOLL", "JU - JUAN DE NOVA ISLAND", "KE - KENYA", "KG - KYRGYZSTAN", "KN - KOREA, NORTH", "KQ - KINGMAN REEF", "KR - KIRIBATI", "KS - KOREA, SOUTH", "KT - CHRISTMAS ISLAND", "KU - KUWAIT", "KZ - KAZAKHSTAN", "LA - LAOS", "LC - ST. LUCIA AND ST. VINCENT", "LE - LEBANON", "LG - LATVIA", "LH - LITHUANIA", "LI - LIBERIA", "LN - SOUTHERN LINE ISLANDS", "LO - SLOVAKIA", "LQ - PALMYRA ATOLL", "LS - LIECHTENSTEIN", "LT - LESOTHO", "LU - LUXEMBOURG", "LY - LIBYA", "MA - MADAGASCAR", "MB - MARTINIQUE", "MC - MACAU", "MD - MOLDOVA", "ME - MADEIRA", "MF - MAYOTTE", "MG - MONGOLIA", "MH - MONTSERRAT", "MI - MALAWI", "MK - MACEDONIA", "ML - MALI", "MM - BURMA (MYANMAR)", "MN - MONACO", "MO - MOROCCO", "MP - MAURITIUS", "MQ - MIDWAY ISLANDS", "MR - MAURITANIA", "MT - MALTA", "MU - OMAN", "MV - MALDIVES", "MW - MONTENEGRO", "MX - MEXICO", "MY - MALAYSIA", "MZ - MOZAMBIQUE", "NC - NEW CALEDONIA", "NE - NIUE", "NF - NORFOLK ISLAND", "NG - NIGER", "NH - VANUATU", "NI - NIGERIA", "NL - NETHERLANDS", "NO - NORWAY", "NP - NEPAL", "NR - NAURU", "NS - SURINAME", "NT - NETHERLANDS ANTILLES", "NU - NICARAGUA", "NZ - NEW ZEALAND", "OW - OCEAN WEATHER STATIONS", "PA - PARAGUAY", "PC - PITCAIRN ISLANDS", "PE - PERU", "PF - PARACEL ISLANDS", "PG - SPRATLY ISLANDS", "PI - PHOENIX ISLANDS", "PK - PAKISTAN", "PL - POLAND", "PM - PANAMA", "PN - NORTH PACIFIC ISLANDS", "PO - PORTUGAL", "PP - PAPUA NEW GUINEA", "PS - PALAU - TRUST TERRITORY OF THE PACIFIC ISLANDS", "PU - GUINEA-BISSAU", "PZ - SOUTH PACIFIC ISLANDS", "QA - QATAR", "RE - REUNION AND ASSOCIATED ISLANDS", "RM - MARSHALL ISLANDS", "RO - ROMANIA", "RP - PHILIPPINES", "RQ - PUERTO RICO", "RS - RUSSIA", "RW - RWANDA", "SA - SAUDI ARABIA", "SB - ST. PIERRE AND MIQUELON", "SC - ST. KITTS AND NEVIS", "SE - SEYCHELLES", "SF - SOUTH AFRICA", "SG - SENEGAL", "SH - ST. HELENA", "SI - SLOVENIA", "SK - SARAWAK AND SABA", "SL - SIERRA LEONE", "SM - SAN MARINO", "SN - SINGAPORE", "SO - SOMALIA", "SP - SPAIN", "SR - SERBIA", "SS - ST. MAARTEN", "ST - ST. LUCIA", "SU - SUDAN", "SV - SVALBARD", "SW - SWEDEN", "SX - SOUTH GEORGIA AND THE SOUTH SANDWICH ISLANDS", "SY - SYRIA", "SZ - SWITZERLAND", "TC - UNITED ARAB EMIRATES", "TD - TRINIDAD AND TOBAGO", "TE - TROMELIN ISLAND", "TH - THAILAND", "TI - TAJIKISTAN", "TK - TURKS AND CAICOS ISLANDS", "TL - TOKELAU", "TN - TONGA", "TO - TOGO", "TP - SAO TOME AND PRINCIPE", "TS - TUNISIA", "TU - TURKEY", "TV - TUVALU", "TW - TAIWAN", "TX - TURKMENISTAN", "TZ - TANZANIA", "UA - FORMER USSR (ASIA)", "UE - FORMER USSR (EUROPE)", "UG - UGANDA", "UK - UNITED KINGDOM", "UP - UKRAINE", "US - UNITED STATES", "UV - BURKINA FASO", "UY - URUGUAY", "UZ - UZBEKISTAN", "VC - ST. VINCENT AND THE GRENADINES", "VE - VENEZUELA", "VI - VIRGIN ISLANDS (BRITISH)", "VM - VIETNAM", "VQ - VIRGIN ISLANDS (U.S.)", "VT - VATICAN CITY", "WA - NAMIBIA", "WE - WEST BANK", "WF - WALLIS AND FUTUNA", "WI - WESTERN SAHARA", "WQ - WAKE ISLAND", "WS - WESTERN SAMOA", "WZ - SWAZILAND", "YM - YEMEN", "YU - YUGOSLAVIA (& FORMER TERRITORY)", "YY - ST. MARTEEN, ST. EUSTATIUS, AND SABA", "ZA - ZAMBIA", "ZI - ZIMBABWE", "ZM - SAMOA", "ZZ - ST. MARTIN AND ST. BARTHOLOMEW" }));
        comboPaises.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                comboPaisesActionPerformed(evt);
            }
        });

        lblEstacao.setText("Estação:");

        comboEstacao.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "TODOS" }));

        btnExecutar.setText("Executar");
        btnExecutar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExecutarActionPerformed(evt);
            }
        });

        lblSaida.setFont(new java.awt.Font("Ubuntu", 1, 15)); // NOI18N
        lblSaida.setText("Saída");

        txtSaida.setColumns(20);
        txtSaida.setRows(5);
        jScrollPane1.setViewportView(txtSaida);

        lblDirEntrada.setText("Diretório de entrada (arquivos): ");

        lblDirSaida.setText("Diretório de saída:");

        txtDirSaida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtDirSaidaActionPerformed(evt);
            }
        });

        lblArquivos.setFont(new java.awt.Font("Ubuntu", 1, 15)); // NOI18N
        lblArquivos.setText("Arquivos:");

        javax.swing.GroupLayout abaFuncoesLayout = new javax.swing.GroupLayout(abaFuncoes);
        abaFuncoes.setLayout(abaFuncoesLayout);
        abaFuncoesLayout.setHorizontalGroup(
            abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(abaFuncoesLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, abaFuncoesLayout.createSequentialGroup()
                        .addComponent(jSeparator2)
                        .addGap(30, 30, 30))
                    .addGroup(abaFuncoesLayout.createSequentialGroup()
                        .addComponent(jScrollPane1)
                        .addContainerGap())
                    .addGroup(abaFuncoesLayout.createSequentialGroup()
                        .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jLabel3)
                                .addGroup(abaFuncoesLayout.createSequentialGroup()
                                    .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(lblPeriodo)
                                        .addComponent(jLabel5)
                                        .addComponent(lblEstacao))
                                    .addGap(42, 42, 42)
                                    .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(comboPaises, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addGroup(abaFuncoesLayout.createSequentialGroup()
                                            .addComponent(dtChooserDe, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(jLabel4)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(jDateChooser1, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addComponent(comboEstacao, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addGroup(abaFuncoesLayout.createSequentialGroup()
                                        .addComponent(jLabel2)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(comboAgrupar, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, abaFuncoesLayout.createSequentialGroup()
                                        .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabel1)
                                            .addComponent(lblVariavel))
                                        .addGap(44, 44, 44)
                                        .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(comboFuncoes, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(comoVariaiveis, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))))
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, abaFuncoesLayout.createSequentialGroup()
                                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(lblDirEntrada)
                                    .addComponent(lblDirSaida))
                                .addGap(18, 18, 18)
                                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(txtDirSaida)
                                    .addGroup(abaFuncoesLayout.createSequentialGroup()
                                        .addComponent(txtDirEntrada, javax.swing.GroupLayout.PREFERRED_SIZE, 303, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(0, 0, Short.MAX_VALUE)))))
                        .addContainerGap(60, Short.MAX_VALUE))
                    .addGroup(abaFuncoesLayout.createSequentialGroup()
                        .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblArquivos)
                            .addComponent(btnExecutar, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblSaida))
                        .addGap(0, 0, Short.MAX_VALUE))))
            .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(abaFuncoesLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jSeparator3)
                    .addContainerGap()))
            .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(abaFuncoesLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jSeparator4, javax.swing.GroupLayout.DEFAULT_SIZE, 588, Short.MAX_VALUE)
                    .addContainerGap()))
        );
        abaFuncoesLayout.setVerticalGroup(
            abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(abaFuncoesLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(comboFuncoes, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblVariavel)
                    .addComponent(comoVariaiveis, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comboAgrupar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 6, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jDateChooser1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(abaFuncoesLayout.createSequentialGroup()
                        .addComponent(jLabel3)
                        .addGap(2, 2, 2)
                        .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(lblPeriodo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(dtChooserDe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comboPaises, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel5))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comboEstacao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblEstacao))
                .addGap(27, 27, 27)
                .addComponent(lblArquivos)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblDirEntrada)
                    .addComponent(txtDirEntrada, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtDirSaida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblDirSaida))
                .addGap(18, 18, 18)
                .addComponent(btnExecutar)
                .addGap(18, 18, 18)
                .addComponent(lblSaida)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 154, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
            .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(abaFuncoesLayout.createSequentialGroup()
                    .addGap(260, 260, 260)
                    .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(355, Short.MAX_VALUE)))
            .addGroup(abaFuncoesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(abaFuncoesLayout.createSequentialGroup()
                    .addGap(376, 376, 376)
                    .addComponent(jSeparator4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(239, Short.MAX_VALUE)))
        );

        painelAbas.addTab("Funções Estatísticas", abaFuncoes);

        javax.swing.GroupLayout abaPredicaoLayout = new javax.swing.GroupLayout(abaPredicao);
        abaPredicao.setLayout(abaPredicaoLayout);
        abaPredicaoLayout.setHorizontalGroup(
            abaPredicaoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 612, Short.MAX_VALUE)
        );
        abaPredicaoLayout.setVerticalGroup(
            abaPredicaoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 612, Short.MAX_VALUE)
        );

        painelAbas.addTab("Predição de Valores", abaPredicao);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(painelAbas, javax.swing.GroupLayout.PREFERRED_SIZE, 620, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(painelAbas, javax.swing.GroupLayout.PREFERRED_SIZE, 650, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void comoVariaiveisActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comoVariaiveisActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_comoVariaiveisActionPerformed

    private void comboPaisesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comboPaisesActionPerformed

        //Ao selecionar o pais, disponibilizar todas as estacoes
        String pais = ((String) this.comboPaises.getSelectedItem()).split(" - ")[0].trim();
        
        Map<String, List<String>> mapaPaisEstacoes = MapaEstacoes.getMapaPaisEstacoes();
        List<String> listaEstacoes = mapaPaisEstacoes.get(pais);
        
        this.comboEstacao.removeAllItems();
        
        this.comboEstacao.addItem("TODOS");
        
        if(listaEstacoes != null)
            for(String estacao : listaEstacoes)
                this.comboEstacao.addItem(estacao);
    }//GEN-LAST:event_comboPaisesActionPerformed

    private void btnExecutarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExecutarActionPerformed
        
        //Obter os parâmetros
        String funcao = "";
        Class<? extends Reducer> reducerClass;
        String[] argumentos;
        Job jb;
        
        reducerClass = null;
        
        //1 Funcao
        switch(this.comboFuncoes.getSelectedIndex())
        {            
            case 0:
                //Média
                reducerClass = MediaReducer.class;
                funcao = "media";
                break;
            case 1: 
                //Desvio padrão
                reducerClass = DpReducer.class;
                funcao = "dp";
                break;
            case 2:
                //Máximo
                reducerClass = MaxReducer.class;
                funcao = "max";
                break;
            case 3:
                //Mínimo
                reducerClass = MinReducer.class;
                funcao = "min";
                break;
            case 4:
                //Mediana
                reducerClass = MedianaReducer.class;
                funcao = "mediana";
                break;
            case 6:
                //Moda
                reducerClass = ModaReducer.class;
                funcao = "moda";
                break;
        }
        
        //2 - Variável
        String variavel = ((String)this.comoVariaiveis.getSelectedItem()).split(" - ")[0];
        
        //3 - Agrupador
        String agrupador = ((String)this.comboAgrupar.getSelectedItem()).split(" - ")[0];
        
        //4 - Período (Esperando Giovani implementar filtro)
        String periodo = "1929-1935";
        
        //5 - País
        String pais = ((String)this.comboPaises.getSelectedItem()).split(" - ")[0];
        
        //6 - Estação
        String estacao = ((String)this.comboEstacao.getSelectedItem()).split(" - ")[0];
        
        //7 - Diretório de entrada
        String entrada = this.txtDirEntrada.getText();
        
        //8 - Diretório de saída
        String saida = this.txtDirSaida.getText();
        
        //Montar o array de argumentos
        argumentos = new String[7];
        argumentos[0] = entrada;
        argumentos[1] = variavel;
        argumentos[2] = periodo;
        argumentos[3] = agrupador;
        argumentos[4] = saida;
        argumentos[5] = pais;
        argumentos[6] = estacao;
        
        try
        {
            jb = StatisticsJobConf.getJob(StatisticsGUI.class, funcao, GroupMapper.class, reducerClass, argumentos);
            
            if(!jb.waitForCompletion(true))
            {
                JOptionPane.showMessageDialog(this, "Houve um erro ao executar o Job :(", "Erro", JOptionPane.ERROR_MESSAGE);
            }
        }
        catch(Exception e)
        {
            JOptionPane.showMessageDialog(this, "Não foi possível criar o job do MapReduce :(", "Erro", JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnExecutarActionPerformed

    private void txtDirSaidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtDirSaidaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtDirSaidaActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("GTK+".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(StatisticsGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(StatisticsGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(StatisticsGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(StatisticsGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new StatisticsGUI().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel abaFuncoes;
    private javax.swing.JPanel abaPredicao;
    private javax.swing.JButton btnExecutar;
    private javax.swing.JComboBox<String> comboAgrupar;
    private javax.swing.JComboBox<String> comboEstacao;
    private javax.swing.JComboBox<String> comboFuncoes;
    private javax.swing.JComboBox<String> comboPaises;
    private javax.swing.JComboBox<String> comoVariaiveis;
    private com.toedter.calendar.JDateChooser dtChooserDe;
    private com.toedter.calendar.JDateChooser jDateChooser1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JSeparator jSeparator4;
    private javax.swing.JLabel lblArquivos;
    private javax.swing.JLabel lblDirEntrada;
    private javax.swing.JLabel lblDirSaida;
    private javax.swing.JLabel lblEstacao;
    private javax.swing.JLabel lblPeriodo;
    private javax.swing.JLabel lblSaida;
    private javax.swing.JLabel lblVariavel;
    private javax.swing.JTabbedPane painelAbas;
    private javax.swing.JTextField txtDirEntrada;
    private javax.swing.JTextField txtDirSaida;
    private javax.swing.JTextArea txtSaida;
    // End of variables declaration//GEN-END:variables
}
